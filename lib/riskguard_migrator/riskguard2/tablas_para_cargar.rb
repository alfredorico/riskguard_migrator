module RiskguardMigrator
  class Riskguard2::TablasParaCargar

    def initialize(parametros_migracion = {})
      @todas_las_tablas_riskguard2 = ['ro_factores', 'ro_lineas_negocios_nivel1', 'ro_lineas_negocios_nivel2', 'ro_eventos_perdidas_nivel1', 'ro_eventos_perdidas_nivel2', 'ro_eventos_perdidas_nivel3', 'ro_canales', 'tc_estados', 'tc_tipos_agencias', 'tc_regiones', 'tc_agencias', 'tc_unidades', 'tc_areas', 'tc_dependencias', 'users', 'ro_registros_riesgos', 'ro_riesgos', 'ro_frecuencias', 'ro_impactos', 'ro_niveles_riesgos', 'ro_niveles_criticidades', 'ro_tipos_procesos', 'ro_procesos', 'ro_tipos_productos_servicios', 'ro_productos_servicios', 'ro_productos_servicios_ro_procesos', 'ro_detalles_riesgos', 'tc_cuentas_contables', 'ro_eventos_perdidas', 'ro_recuperaciones_eventos', 'ro_cuentas_contables_recuperaciones_eventos', 'ro_controles', 'ro_tipos_controles_coberturas', 'ro_tipos_controles_fases', 'ro_tipos_controles_frecuencias', 'ro_tipos_controles_implementaciones', 'ro_tipos_controles_reducciones', 'ro_tipos_controles_disenos', 'ro_controles_evaluaciones', 'ro_controles_actuales', 'ro_tipos_mitigantes', 'ro_mitigantes', 'ro_porcentajes_avances', 'ro_seguimientos', 'tc_actividades_economicas', 'tc_naturalezas_clientes', 'tc_generos', 'tc_tipos_personas', 'tc_mayores_contables', 'tc_tipos_documentos', 'tc_paises', 'tc_segmentos_clientes', 'tc_clientes', 'rc_categorias_tipos_productos_crediticios', 'rc_tipos_productos_crediticios', 'rc_productos_crediticios', 'tc_tipos_tasas_intereses', 'tc_monedas', 'rc_destinos_creditos', 'rc_estados_creditos', 'tc_periodicidades', 'rc_tipos_lineas_creditos', 'rc_lineas_creditos', 'rc_creditos', 'rm_tipos_productos_pasivos', 'rm_tipos_vencimientos_pasivos', 'rm_productos_pasivos', 'rm_cuentas', 'tc_calendarios_bancarios', 'tc_contabilidades_diarias_agencias', 'tc_cierres_contables', 'tc_saldos_promedio_mensuales_agencias', 'tc_periodicidades_tasas', 'rm_cuentas_vistas', 'rm_cuentas_plazos', 'tc_tipos_cambios', 'tc_tipos_cambios_tc_monedas', 'rc_calificaciones', 'rc_situaciones_contables', 'rc_estados_pagos', 'rc_carteras_creditos', 'rc_pagos', 'rc_pagos_calendarios', 'rc_tipos_garantias', 'rc_tipos_bienes', 'rc_bienes', 'rc_situaciones_garantias', 'rc_garantias', 'rc_creditos_rc_garantias', 'rm_tipos_inversiones', 'rm_custodios', 'rm_emisores', 'rm_bases_calculos', 'rm_restricciones', 'rm_tipos_instrumentos', 'rm_inversiones', 'rm_categorias_instrumentos', 'rm_tipos_operaciones', 'rm_inversiones_diarias', 'ro_lineas_negocios_nivel2_ro_productos_servicios', 'ro_productos_servicios_ro_procesos_ro_eventos_perdidas', 'ro_frecuencias_ro_impactos', 'tc_cuentas_contables_rm_productos_pasivos', 'tc_contabilidades_diarias', 'ro_productos_servicios_ro_procesos_ro_registros_riesgos', 'rl_parametros_volatilidades_depositos', 'ro_detalles_riesgos_residuales', 'tc_feriados', 'fechas_cargadas', 'log_proceso_de_carga', 'mantenimiento', 'definiciones_archivos_planos', 'ro_ultimos_seguimientos', 'ro_inherencias', 'ro_registros_riesgos_ro_inherencias', 'rn_tipos_marcos_legales', 'rn_emisores', 'rn_marcos_legales', 'rn_tipos_causas_legales', 'rn_tipos_demandantes', 'rn_autoridades_judiciales', 'rn_decisiones_causas_legales', 'rn_estatus_causas_legales', 'rn_causas_legales', 'rn_seguimientos_causas_legales', 'ro_lineas_negocios_nivel1_tc_cuentas_contables', 'rn_riesgos', 'rn_frecuencias', 'rn_impactos', 'rn_niveles_riesgos', 'rn_frecuencias_rn_impactos', 'rn_registros_riesgos', 'rn_registros_riesgos_rn_marcos_legales', 'rn_controles', 'rn_factores', 'rn_detalles_riesgos', 'rn_controles_actuales', 'rn_detalles_riesgos_controles', 'rn_mitigantes', 'rn_seguimientos', 'rn_detalles_riesgos_residuales', 'rr_riesgos', 'rr_frecuencias', 'rr_impactos', 'rr_niveles_riesgos', 'rr_frecuencias_rr_impactos', 'rr_registros_riesgos', 'rr_controles', 'rr_factores', 'rr_impactos_patrimoniales', 'rr_detalles_riesgos', 'rr_controles_actuales', 'rr_detalles_riesgos_controles', 'rr_mitigantes', 'rr_seguimientos', 'rr_detalles_riesgos_residuales', 'rc_severidades_irb', 'rc_categorias_basilea', 'rc_categorias_basilea_rc_productos_crediticios', 'rm_precios_mercado', 'ro_detalles_riesgos_controles', 'rc_historicos_garantias', 'rm_parametros_var', 'rc_marcas_tarjetas', 'rc_categorias_tarjetas', 'rc_motivos_bloqueos_tarjetas', 'rc_motivos_cancelaciones_tarjetas', 'rc_lineas_creditos_tarjetas', 'rc_tarjetas', 'rc_tarjetas_creditos', 'tc_cuentas_contables_apodos', 'proyecto_implantacion', 'rc_pagos_tarjetas', 'rn_ambitos', 'rn_ambitos_rn_marcos_legales', 'rm_parametros_var_mercado', 'rc_lgd_garantias', 'rm_productos_pasivos_para_depositos_a_plazo_a_vencer', 'caracteristicas', 'rc_tarjetas_productos_tarjetas', 'ro_ausencia_eventos_perdidas', 'observaciones_users', 'rn_indicadores', 'rn_insumos_indicadores', 'rn_detalles_indicadores', 'rc_efev_fichas', 'rn_indicadores_registro', 'rc_efev_ficha_accionistas', 'rc_efev_ficha_evoluciones', 'rc_efev_ficha_financieras', 'rc_efev_ingreso_fichas_tmp', 'rm_parametros_simulacion_montecarlo', 'rm_antecedentes_titulos', 'rm_carteras', 'ro_cuentas_contables_perdidas', 'ro_cuentas_contables_metodo_basico', 'rc_alertas_morosidad', 'rl_parametros_indicadores']
      #@tablas_proceso_de_carga = Riskguard2::DefinicionArchivoPlano.all.map(&:nombre_tabla)
      @tablas_proceso_de_carga = ['tc_agencias', 'tc_cuentas_contables', 'tc_contabilidades_diarias', 'tc_contabilidades_diarias_agencias', 'tc_clientes', 'rc_lineas_creditos', 'rc_creditos', 'rc_carteras_creditos', 'rc_pagos', 'rc_pagos_calendarios', 'rc_garantias', 'rc_creditos_rc_garantias', 'rm_cuentas', 'rm_cuentas_vistas', 'rm_cuentas_plazos', 'rm_inversiones', 'rm_inversiones_diarias', 'rc_tarjetas', 'rc_tarjetas_creditos', 'rc_pagos_tarjetas']
      @archivos_planos_introducidos = parametros_migracion[:archivos_planos_introducidos]
      @criterio_seleccion_archivos_planos = parametros_migracion[:criterio_seleccion_archivos_planos]
      @verificar_si_fue_insertada = true
    end

    def listado_tablas_para_cargar
      case @criterio_seleccion_archivos_planos
      when :inclusion
        @todas_las_tablas_riskguard2 - (@tablas_proceso_de_carga - @archivos_planos_introducidos)
      when :exclusion
        @todas_las_tablas_riskguard2 - @archivos_planos_introducidos
      when :tablas_especificas
        @verificar_si_fue_insertada = false
        @archivos_planos_introducidos
      else
        @todas_las_tablas_riskguard2
      end.map{|nombre_tabla| Riskguard2::Tabla.new(nombre_tabla,@verificar_si_fue_insertada) }
    end

  end
end
